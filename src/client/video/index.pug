include ../common/common.pug

+Page("Cabinet Videos", "video")
  #cover
    button#button-cover-close Close

  +Prefs
    label
      span Use privacy cover
      input(type="checkbox" name="pref-usePrivacyCover" checked=preferences.usePrivacyCover)
    label
      span Group videos by folder
      input(type="checkbox" name="pref-groupVideosByFolder" checked=preferences.groupVideosByFolder)
    label
      span Hide disliked videos
      input(type="checkbox" name="pref-hideDislikedVideos" checked=preferences.hideDislikedVideos)
    label
      span Show video thumbnails
      input(type="checkbox" name="pref-showVideoThumbnails" checked=preferences.showVideoThumbnails)

  #player
    video#video(autoplay)
    #overlay
      #title
        #title-text
          #title-name
          #title-error
        #title-controls
          button#button-list-show ☰
      #overlay-middle
        #targets
          .target
          .target
        #touch-only-controls
          button#button-playback-touch-only
        #notification
          #notification-text
          #notification-progress-container
            #notification-progress
      #player-controls
        #playback-montages-container
          #playback-montages
            each folder in folders
              each video in folder.videos
                if video.preview
                  .playback-montage(data-id=video.id)
                    .playback-montage-frames
                      each frame in video.preview.montageFrames
                        img.playback-montage-frame.lazy(data-time=frame.time data-src=frame.URL)
          #playback-montage-overlay
            .playback-montage-overlay-mask
            #playback-montage-overlay-window
            .playback-montage-overlay-mask
        input#progress(type="range" value=0 min=0 step=0.1)
        if _signedIn
          button#button-like &#x1F44D
          button#button-dislike &#x1F44E
        #time 0:00 / -0:00
        #speed
          label.speed-option
            input(name='speed' type='radio' hidden value=0.25)
            div 0.25x
          label.speed-option
            input(name='speed' type='radio' hidden value=0.5)
            div 0.5x
          label.speed-option
            input(name='speed' type='radio' hidden value=0.75)
            div 0.75x
          label.speed-option
            input(name='speed' type='radio' hidden value=1 checked)
            div 1x
          label.speed-option
            input(name='speed' type='radio' hidden value=1.25)
            div 1.25x
          label.speed-option
            input(name='speed' type='radio' hidden value=1.5)
            div 1.5x
          label.speed-option
            input(name='speed' type='radio' hidden value=1.75)
            div 1.75x
          label.speed-option
            input(name='speed' type='radio' hidden value=2)
            div 2x
        button#button-fullscreen

  #pane
    #pane-toolbar
      input#search(placeholder="Search")
      button#button-list-hide ―
      button#button-settings ⚙
    dl#folders
      each folder in folders
        dt.folder-name= folder.name
        dd.folder-videos-container
          ul.folder-videos-list
            each video in folder.videos
              //- It's too much hassle to use an <a> as we have to then prevent
              //- all the default UA behaviour, some of which are not preventable
              //- on old browsers. For example, Edge has no way of hiding the
              //- distracting URL popup when focus is left on the link after
              //- touching, even when blurred afterwards.
              li.entry(
                data-id=video.id,
                data-liked=video.liked,
                data-disliked=video.disliked,
              )
                if video.preview
                  .entry-preview(
                    data-width=video.preview.width,
                    data-height=video.preview.height,
                  )
                    img.entry-thumbnail.lazy(data-src=video.preview.thumbnail)
                    video.entry-snippet.lazy(data-src=video.preview.snippet muted)
                span.entry-title= video.title
    #pane-controls
      button#button-previous(title="Previous") ⏮
      button#button-stop(title="Stop") ⏹
      button#button-next(title="Next") ⏭
